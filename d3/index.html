<script src="https://d3js.org/d3.v6.min.js"></script>

<body>
  <script>

    var svg = d3.select("body")
      .append("svg")
      .attr("width", 1000)
      .attr("height", 600)
      .append("g")
      .attr("transform", "translate(80, 20)");

    // load csv
    d3.csv("penglings.csv").then(function(data) {

        // make x and y scales
        var xScale = d3.scaleLinear()
            .domain([170, 230])
            .range([0, 900]);

        var yScale = d3.scaleLinear()
            .domain([2000, 7000])
            .range([500, 0]);

        // make bubble size scale
        var bubScale = d3.scaleSqrt()
            .domain([0, 59.6])
            .range([-20, 20]);

        // make color scale
        var colorScale = d3.scaleOrdinal()
            .domain(["Adelie", "Gentoo", "Chinstrap"])
            .range(["#D50F25", "#EEB211", "#3369E8"]);

        // x axis
        svg.append("g")
            .attr("transform", "translate(0," + 500 + ")")
            .call(d3.axisBottom(xScale).tickValues(d3.range(170, 231, 10)))
            .selectAll(".tick")
            .append("line")
            .attr("y1", 0)
            .attr("y2", -500)
            .attr("stroke", "#ddd");
        svg.append("text")
            .attr("x", 350)
            .attr("y", 560)
            .style("fill", "black")
            .style("font-size", "24px")
            .text("Flipper Length (mm)");

        // y axis
        svg.append("g")
            .call(d3.axisLeft(yScale).tickValues(d3.range(2000, 7001, 1000)))
            .selectAll(".tick")
            .append("line")
            .attr("x1", 0)
            .attr("x2", 900)
            .attr("stroke", "#ddd");
        svg.append("text")
            .attr("transform", "rotate(-90)")
            .attr("x", -320)
            .attr("y", -45)
            .style("fill", "black")
            .style("font-size", "24px")
            .text("Body Mass (g)");

        // plot data
        svg.selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr("cx", function(d) { return xScale(+d.flipper_length_mm); })
            .attr("cy", function(d) { return yScale(+d.body_mass_g); })
            .attr("r", function(d) { return bubScale(+d.bill_length_mm); }) // "Size mapping to Bill Length."
            .attr("fill", function(d) { return colorScale(d.species); }) // "Color mapping to species."
            .attr("opacity", 0.7);
    });
  </script>
</body>
</html>
